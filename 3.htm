<div id="container">
    <!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-transform"/>
    <meta name="sogou_site_verification" content="xSIboraCiG"/>
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <meta name="keywords" content="博客,搭建,CentOs,Tale"/>
    <meta name="description" content="一段代码，一个故事"/>
    <link rel="shortcut icon" href="favicon.png" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/img/favicon.png"/>
    <link rel="apple-touch-icon" href="apple-touch-icon.png" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/img/apple-touch-icon.png"/>
    <script src="main.js" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/js/main.js"></script>
    <link href="style.min.css" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/css/style.min.css" rel="stylesheet">
    <link href="prism.css" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/css/prism.css" rel="stylesheet">
    <title>#2017-09-10# Tale模板框架博客搭建记录 - petterObam</title>
    <script src="particles.min.js" tppabs="http://cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script>
</head>
<body  gtools_scp_screen_capture_injected="true">
<!--[if lt IE 8]>
<div class="browsehappy" role="dialog">
    当前网页 <strong>不支持</strong> 你正在使用的浏览器. 为了正常的访问, 请 <a href="javascript:if(confirm(%27http://browsehappy.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://browsehappy.com/%27" tppabs="http://browsehappy.com/" target="_blank">升级你的浏览器</a>。
</div>
<![endif]-->
<div class="left-col">
    <div class="overlay"></div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="index.htm" tppabs="http://www.oyjie.cn/" class="profilepic">
                <img src="logo.png.jpg" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/img/logo.png" class="js-avatar">
            </a>
            <hgroup>
                <h1 class="header-author"><a href="index.htm" tppabs="http://www.oyjie.cn/">petterObam</a></h1>
                <p class="subtitle">一段代码，一个故事</p>
            </hgroup>
            <nav class="header-menu">
                <ul>
                    <li><a href="index.htm" tppabs="http://www.oyjie.cn/">主页</a></li>
                </ul>
            </nav>
            <nav class="header-smart-menu">
                <a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
                <a class="js-smart-menu" data-idx="1" href="javascript:void(0)">标签</a>
                <a class="js-smart-menu" data-idx="2" href="javascript:void(0)">友链</a>
                <a class="js-smart-menu" data-idx="3" href="javascript:void(0)">关于我</a>
            </nav>
            <nav class="header-nav">
                <div class="social">


                    <a class="social rss" target="blank" href="feed.htm" tppabs="http://www.oyjie.cn/feed">RSS</a>

                    <!---->
                    <a class="github" target="blank"
                       href="javascript:if(confirm(%27https://github.com/petterobam  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://github.com/petterobam%27" tppabs="https://github.com/petterobam">Github</a>
                    

                </div>
            </nav>
        </header>
    </div>
</div>
<div class="tools-col">
    <ul class="btn-wrap">
        <li class="" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
        <li data-hook="tools-section-tag" class="chose"><span class="text"></span><i class="icon-price-tags"></i></li>
        <li data-hook="tools-section-friends" class=""><span class="text">友链</span><i class="icon-link"></i></li>
        <li data-hook="tools-section-me"><span class="text">我</span><i class="icon-smile"></i></li>
    </ul>
    <div class="tools-wrap">
        <section class="tools-section tools-section-all">

        </section>
        <section class="tools-section tools-section-tag chose">
            <div class="widget tagcloud" id="js-tagcloud">
                <a href="PDF.htm" tppabs="http://www.oyjie.cn/tag/PDF" style="font-size: 12px;" class="color3">PDF</a>
                <a href="CentOs.htm" tppabs="http://www.oyjie.cn/tag/CentOs" style="font-size: 12px;" class="color3">CentOs</a>
                <a href="sqlite.htm" tppabs="http://www.oyjie.cn/tag/sqlite" style="font-size: 12px;" class="color3">sqlite</a>
                <a href="面向对象.htm" tppabs="http://www.oyjie.cn/tag/面向对象" style="font-size: 12px;" class="color3">面向对象</a>
                <a href="封装.htm" tppabs="http://www.oyjie.cn/tag/封装" style="font-size: 12px;" class="color3">封装</a>
                <a href="数据库.htm" tppabs="http://www.oyjie.cn/tag/数据库" style="font-size: 12px;" class="color3">数据库</a>
                <a href="打包.htm" tppabs="http://www.oyjie.cn/tag/打包" style="font-size: 12px;" class="color3">打包</a>
                <a href="代码合并.htm" tppabs="http://www.oyjie.cn/tag/代码合并" style="font-size: 12px;" class="color3">代码合并</a>
                <a href="代码提交.htm" tppabs="http://www.oyjie.cn/tag/代码提交" style="font-size: 12px;" class="color3">代码提交</a>
                <a href="文本分析.htm" tppabs="http://www.oyjie.cn/tag/文本分析" style="font-size: 12px;" class="color3">文本分析</a>
                <a href="聚类.htm" tppabs="http://www.oyjie.cn/tag/聚类" style="font-size: 12px;" class="color3">聚类</a>
                <a href="分词.htm" tppabs="http://www.oyjie.cn/tag/分词" style="font-size: 12px;" class="color3">分词</a>
                <a href="WORD.htm" tppabs="http://www.oyjie.cn/tag/WORD" style="font-size: 12px;" class="color3">WORD</a>
                <a href="数据提取.htm" tppabs="http://www.oyjie.cn/tag/数据提取" style="font-size: 12px;" class="color3">数据提取</a>
                <a href="解析.htm" tppabs="http://www.oyjie.cn/tag/解析" style="font-size: 12px;" class="color3">解析</a>
                <a href="Word-1.htm" tppabs="http://www.oyjie.cn/tag/Word" style="font-size: 12px;" class="color3">Word</a>
                <a href="Tale.htm" tppabs="http://www.oyjie.cn/tag/Tale" style="font-size: 12px;" class="color3">Tale</a>
                <a href="项目经理.htm" tppabs="http://www.oyjie.cn/tag/项目经理" style="font-size: 12px;" class="color3">项目经理</a>
                <a href="项目管控.htm" tppabs="http://www.oyjie.cn/tag/项目管控" style="font-size: 12px;" class="color3">项目管控</a>
                <a href="邮件.htm" tppabs="http://www.oyjie.cn/tag/邮件" style="font-size: 12px;" class="color3">邮件</a>
                <a href="定时任务.htm" tppabs="http://www.oyjie.cn/tag/定时任务" style="font-size: 12px;" class="color3">定时任务</a>
                <a href="maillx.htm" tppabs="http://www.oyjie.cn/tag/maillx" style="font-size: 12px;" class="color3">maillx</a>
                <a href="搭建.htm" tppabs="http://www.oyjie.cn/tag/搭建" style="font-size: 12px;" class="color3">搭建</a>
                <a href="博客.htm" tppabs="http://www.oyjie.cn/tag/博客" style="font-size: 12px;" class="color3">博客</a>
                <a href="aaa.htm" tppabs="http://www.oyjie.cn/tag/aaa" style="font-size: 12px;" class="color3">aaa</a>
                <a href="心得.htm" tppabs="http://www.oyjie.cn/tag/心得" style="font-size: 12px;" class="color3">心得</a>
                <a href="linux.htm" tppabs="http://www.oyjie.cn/tag/linux" style="font-size: 12px;" class="color3">linux</a>
                <a href="tale-1.htm" tppabs="http://www.oyjie.cn/tag/tale" style="font-size: 12px;" class="color3">tale</a>
            </div>
        </section>
        <section class="tools-section tools-section-friends">
            <div class="friends-wrap" id="js-friends">
                <a target="_blank" class="main-nav-link switch-friends-link" href="javascript:if(confirm(%27http://mindhacks.cn/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://mindhacks.cn/%27" tppabs="http://mindhacks.cn/">刘未鹏 | Mind Hacks</a>
                <a target="_blank" class="main-nav-link switch-friends-link" href="javascript:if(confirm(%27http://www.xiashuo.online/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.xiashuo.online/%27" tppabs="http://www.xiashuo.online/">把灯瞎说的博客</a>
                <a target="_blank" class="main-nav-link switch-friends-link" href="javascript:if(confirm(%27http://biezhi.me/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://biezhi.me/%27" tppabs="http://biezhi.me/">王爵的技术博客</a>
            </div>
        </section>
        <section class="tools-section tools-section-me">
            <div class="aboutme-wrap" id="js-aboutme"></div>
        </section>
    </div>
</div>

    <div class="mid-col">
        <article class="article article-type-post  animated fadeInLeft" itemscope="" itemprop="blogPost">
            <div class="article-inner">
                <input type="hidden" class="isFancy">
                <header class="article-header">
                    <h1 itemprop="name">
                        <a name="title" class="article-title" href="3.htm" tppabs="http://www.oyjie.cn/article/3">#2017-09-10# Tale模板框架博客搭建记录</a>
                    </h1>
                </header>
                <div id="post-content" class="article-entry" itemprop="articleBody">
                    <p><h2>@首先你要有</h2>
<p>服务器（我的是CentOs，在<a href="javascript:if(confirm(%27https://bwh1.net/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://bwh1.net/%27" tppabs="https://bwh1.net/">搬瓦工</a>上买的国外服务器）、电脑、浏览器、WIFI、远程连接工具（我用的是SecureCRT）</p>
<h2>安装jdk1.8</h2>
<pre><code>// 查看可用的jdk
yum search java | grep -i jdk  
	
	ldapjdk-javadoc.x86_64 : Javadoc for ldapjdk
	icedtea-web.x86_64 : Additional Java components for OpenJDK - Java browser
	java-1.6.0-openjdk.x86_64 : OpenJDK Runtime Environment
	java-1.6.0-openjdk-demo.x86_64 : OpenJDK Demos
	java-1.6.0-openjdk-devel.x86_64 : OpenJDK Development Environment
	java-1.6.0-openjdk-javadoc.x86_64 : OpenJDK API Documentation
	java-1.6.0-openjdk-src.x86_64 : OpenJDK Source Bundle
	java-1.7.0-openjdk.x86_64 : OpenJDK Runtime Environment
	java-1.7.0-openjdk-demo.x86_64 : OpenJDK Demos
	java-1.7.0-openjdk-devel.x86_64 : OpenJDK Development Environment
	java-1.7.0-openjdk-javadoc.noarch : OpenJDK API Documentation
	java-1.7.0-openjdk-src.x86_64 : OpenJDK Source Bundle
	java-1.8.0-openjdk.x86_64 : OpenJDK Runtime Environment
	java-1.8.0-openjdk-debug.x86_64 : OpenJDK Runtime Environment with full debug on
	java-1.8.0-openjdk-demo.x86_64 : OpenJDK Demos
	java-1.8.0-openjdk-demo-debug.x86_64 : OpenJDK Demos with full debug on
	java-1.8.0-openjdk-devel.x86_64 : OpenJDK Development Environment
	java-1.8.0-openjdk-devel-debug.x86_64 : OpenJDK Development Environment with
	java-1.8.0-openjdk-headless.x86_64 : OpenJDK Runtime Environment
	java-1.8.0-openjdk-headless-debug.x86_64 : OpenJDK Runtime Environment with full
	java-1.8.0-openjdk-javadoc.noarch : OpenJDK API Documentation
	java-1.8.0-openjdk-javadoc-debug.noarch : OpenJDK API Documentation for packages
	java-1.8.0-openjdk-src.x86_64 : OpenJDK Source Bundle
	java-1.8.0-openjdk-src-debug.x86_64 : OpenJDK Source Bundle for packages with
	ldapjdk.x86_64 : The Mozilla LDAP Java SDK

//安装jdk1.8
yum install java-1.8.0-openjdk.x86_64 
</code></pre>
<h2>iptables 永久打开新端口</h2>
<ol>
<li>
<p>CentOS/RHEL 7</p>
<pre><code> //tale 默认是9000，我们需要开放9000端口
 sudo firewall-cmd --zone=public --add-port=9000/tcp --permanent
 sudo firewall-cmd --zone=public --add-port=80/tcp --permanent
 sudo firewall-cmd --reload 
</code></pre>
</li>
<li>
<p>CentOS/RHEL 6</p>
<pre><code> //tale 默认是9000，我们需要开放9000端口
 sudo iptables -I INPUT -p tcp -m tcp --dport 9000 -j ACCEPT
 sudo iptables -I INPUT -p tcp -m tcp --dport 80 -j ACCEPT
 sudo service iptables save 
</code></pre>
</li>
<li>
<p>查看打开的端口：</p>
<pre><code> /etc/init.d/iptables status
</code></pre>
</li>
</ol>
<h2>nginx 安装配置</h2>
<ol>
<li>
<p>下载</p>
<pre><code> wget http://nginx.org/packages/centos/6/noarch/RPMS/nginx-release-centos-6-0.el6.ngx.noarch.rpm
</code></pre>
</li>
<li>
<p>nginx开启对外映射共享</p>
<pre><code> // 安装源库
 chmod +x nginx-release-centos-6-0.el6.ngx.noarch.rpm 
 // 解压
 rpm -i nginx-release-centos-6-0.el6.ngx.noarch.rpm 
 // 安装nginx
 yum install nginx
 // 启动nginx
 service nginx start
</code></pre>
</li>
<li>
<p>简单说明</p>
<ul>
<li>默认nginx配置文件: /etc/nginx/nginx.conf         【nginx主要的配置文件】</li>
<li>默认nginx的ssl配置文件: /etc/nginx/conf.d/ssl.conf 【配置SSL证书的，也可以并入到nginx.conf 文件里】</li>
<li>默认nginx的虚拟主机配置文件: /etc/nginx/conf.d/virtual.conf 【如同Apache的虚拟主机配置，也可以并入到nginx.conf文件里】</li>
<li>默认的web_root文件夹路径: /usr/share/nginx/html 【web目录夹，放置Magento主程序】</li>
</ul>
</li>
<li>
<p>将你的 web程序文件夹 放到/usr/share/nginx/html下</p>
</li>
</ol>
<h2>在线下载安装tale</h2>
<ol>
<li>
<p>下载</p>
<pre><code> // 请到nginx的html目录下下载
 sudo wget http://7xls9k.dl1.z0.glb.clouddn.com/tale.zip
</code></pre>
</li>
<li>
<p>解压</p>
<pre><code> unzip tale.zip
</code></pre>
</li>
<li>
<p>启动</p>
<pre><code> // 进入tale网站的bin目录下
 cd tale/bin
 // 脚本执行授权
 chmod 755 tale.sh
 // 启动
 sh tale.sh start
 // 默认的启动JVM参数为 -Xms128m -Xmx128m 如果你想修改内存配置可以这样 
 sh tale.sh start &quot;-Xms512m -Xmx512m
 // 关闭博客程序
 sh tale.sh stop
 // 查看日志
 sh tale.sh log
 // 查看启动状态
 sh tale.sh status
</code></pre>
</li>
</ol>
<h2>绑定域名</h2>
<p>通过 IP:端口号，tale默认是9000，访问可以的话，可以去阿里云或其他网站上买个域名，配置好DNS解析，就可以通过域名访问，9000端口不像80是默认端口，在域名后面带个端口比较难看，可以将tale的端口改为80</p>
<pre><code>// 进入配置文件夹
cd tale/resources
// 修改应用配置文件
vi app.properties
//最加一行
server.port=80
cd tale/bin
// 关闭博客程序
sh tale.sh stop
// 启动
sh tale.sh start
</code></pre>
<p>你会发现无法启动，因为80端口被占用了</p>
<pre><code>Exception in thread &quot;main&quot; com.blade.exception.EmbedServerException: java.net.BindException: Address already in use
        at com.blade.embedd.EmbedJettyServer.startup(EmbedJettyServer.java:170)
        at com.blade.embedd.EmbedJettyServer.startup(EmbedJettyServer.java:74)
        at com.blade.Blade.startNoJoin(Blade.java:499)
        at com.blade.Blade.start(Blade.java:472)
        at com.blade.Blade.start(Blade.java:478)
        at com.tale.Application.main(Application.java:11)
Caused by: java.net.BindException: Address already in use
        at sun.nio.ch.Net.bind0(Native Method)
        at sun.nio.ch.Net.bind(Net.java:433)
        at sun.nio.ch.Net.bind(Net.java:425)
        at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:223)
        at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:74)
        at org.eclipse.jetty.server.ServerConnector.open(ServerConnector.java:298)
        at org.eclipse.jetty.server.AbstractNetworkConnector.doStart(AbstractNetworkConnector.java:80)
        at org.eclipse.jetty.server.ServerConnector.doStart(ServerConnector.java:236)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:68)
        at org.eclipse.jetty.server.Server.doStart(Server.java:431)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:68)
        at com.blade.embedd.EmbedJettyServer.startup(EmbedJettyServer.java:166)
        ... 5 more
</code></pre>
<p>需要修改nginx的默认配置，将nginx端口改成其他的</p>
<pre><code>// 修改nginx的默认配置
vi /etc/nginx/conf.d/default.conf
// 将listen改成其他，例如9000
server {
    listen       81;
    server_name  localhost;
    ……
}
// 退出保存，重启nginx
nginx -s reload
</code></pre>
<p>然后在重启tale，就可以了，就是你现在访问的网站 ^_^</p>
</p>
                    <p class="post-info">
                        本文由 <a href="">petterObam</a> 创作，采用 <a href="javascript:if(confirm(%27https://creativecommons.org/licenses/by/4.0/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://creativecommons.org/licenses/by/4.0/%27" tppabs="https://creativecommons.org/licenses/by/4.0/"
                                                           target="_blank"
                                                           rel="external nofollow">知识共享署名4.0</a> 国际许可协议进行许可<br>本站文章除注明转载/出处外，均为本站原创或翻译，转载前请务必署名<br>最后编辑时间为:
                        2018/02/04 02:23
                    </p>
                </div>
                <div class="article-info article-info-index">
                    <div class="article-tag tagcloud">
                        <i class="icon-price-tags"></i>
                        <ul class="article-tag-list">
                            <li class="article-tag-list-item"><a class="color3" href="#"
                                                                 style="font-size: 12px;"><a href="博客-1.htm" tppabs="http://www.oyjie.cn/tag/%E5%8D%9A%E5%AE%A2">博客</a><a href="搭建-1.htm" tppabs="http://www.oyjie.cn/tag/%E6%90%AD%E5%BB%BA">搭建</a><a href="CentOs.htm" tppabs="http://www.oyjie.cn/tag/CentOs">CentOs</a><a href="Tale.htm" tppabs="http://www.oyjie.cn/tag/Tale">Tale</a></a></li>
                        </ul>
                    </div>
                    <div class="post-data archive-article-date">
                        <time datetime="2017-09-10" itemprop="datePublished">发布于 2017-09-10
                        </time>
                        /<span> <a href="框架.htm" tppabs="http://www.oyjie.cn/category/%E6%A1%86%E6%9E%B6">框架</a><a href="CentOs-1.htm" tppabs="http://www.oyjie.cn/category/CentOs">CentOs</a> </span>/ <a href="#comments">4 条评论</a> /
                        370浏览<a name="footer">.</a>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>
        </article>

		<div id="post-bottom-bar" class="post-bottom-bar">
		    <div class="bottom-bar-inner">
		        <div class="bottom-bar-items social-share left">
		            <span class="bottom-bar-item">Share : </span>
		            <span class="bottom-bar-item bottom-bar-facebook"><a href="javascript:if(confirm(%27https://www.facebook.com/sharer/sharer.php?u=http://www.oyjie.cn/article/3  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://www.facebook.com/sharer/sharer.php?u=http://www.oyjie.cn/article/3%27" tppabs="https://www.facebook.com/sharer/sharer.php?u=http://www.oyjie.cn/article/3" target="_blank" title="#2017-09-10# Tale模板框架博客搭建记录" rel="nofollow">facebook</a></span>
		            <span class="bottom-bar-item bottom-bar-twitter"><a href="javascript:if(confirm(%27https://twitter.com/intent/tweet?url=http://www.oyjie.cn/article/3&text=  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://twitter.com/intent/tweet?url=http://www.oyjie.cn/article/3&text=#2017-09-10# Tale模板框架博客搭建记录%27" tppabs="https://twitter.com/intent/tweet?url=http://www.oyjie.cn/article/3&text=#2017-09-10# Tale模板框架博客搭建记录" target="_blank" title="#2017-09-10# Tale模板框架博客搭建记录" rel="nofollow">Twitter</a></span>
		            <span class="bottom-bar-item bottom-bar-weibo"><a href="javascript:if(confirm(%27http://service.weibo.com/share/share.php?url=http://www.oyjie.cn/article/3&title=  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://service.weibo.com/share/share.php?url=http://www.oyjie.cn/article/3&title=#2017-09-10# Tale模板框架博客搭建记录%27" tppabs="http://service.weibo.com/share/share.php?url=http://www.oyjie.cn/article/3&title=#2017-09-10# Tale模板框架博客搭建记录" target="_blank" title="#2017-09-10# Tale模板框架博客搭建记录" rel="nofollow">Weibo</a></span>
		            <span class="bottom-bar-item bottom-bar-qrcode"><a href="javascript:if(confirm(%27http://pan.baidu.com/share/qrcode?w=300&h=300&url=http://www.oyjie.cn/article/3  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://pan.baidu.com/share/qrcode?w=300&h=300&url=http://www.oyjie.cn/article/3%27" tppabs="http://pan.baidu.com/share/qrcode?w=300&h=300&url=http://www.oyjie.cn/article/3" target="_blank" rel="nofollow">QRcode</a></span>
		        </div>
		        <div class="bottom-bar-items right">
		            <span class="bottom-bar-item"></span>
		            <span class="bottom-bar-item"><a href="4.htm" tppabs="http://www.oyjie.cn/article/4" title="#2017-09-17# CentOS自动发邮件">←</a></span>
		            <span class="bottom-bar-item"><a href="#footer">↓</a></span>
		            <span class="bottom-bar-item"><a href="#title">↑</a></span>
		        </div>
		    </div>
		</div>
		
        <div id="3" class="comment-container">
    <div id="comments" class="clearfix">
        <span class="response"></span>

        <form method="post" id="comment-form" class="comment-form" role="form" onsubmit="return TaleComment.subComment();">
            <input type="hidden" name="coid" id="coid"/>
            <input type="hidden" name="cid" id="cid" value="3"/>
            <input type="hidden" name="_csrf_token" value="ARDPR86yI7Tu1ALfx-WDK2"/>
            <input type="text" name="author" maxlength="12" id="author" class="form-control input-control clearfix"
                   placeholder="姓名 (*)" value="" required/>
            <input type="email" name="mail" id="mail" class="form-control input-control clearfix" placeholder="邮箱 (*)"
                   value="" required/>
            <input type="url" name="url" id="url" class="form-control input-control clearfix" placeholder="网址 (http://)"
                   value=""/>
            <textarea name="text" id="textarea" class="form-control" placeholder="请留下你的评论..." required minlength="5" maxlength="2000"></textarea>
            <button type="submit" class="submit" id="misubmit">提交</button>
        </form><br/>




        <ol class="comment-list">
            <li id="li-comment-6" class="comment-body comment-parent comment-odd">
                <div id="comment-6">
                    <div class="comment-view" onclick="">
                        <div class="comment-header">
                            <img class="avatar" src="6ad193f57f79ac444c3621370da955e9-s=80&r=G&d=" tppabs="https://secure.gravatar.com/avatar/6ad193f57f79ac444c3621370da955e9?s=80&r=G&d=" title="路人1519384347269"
                                 width="80" height="80">
                            <span class="comment-author">
                                <a href="" target="_blank" rel="external nofollow">路人1519384347269</a>
                            </span>
                        </div>
                        <div class="comment-content">
                            <span class="comment-author-at"></span>
                            <p><p>已经改进了</p>
</p>
                        </div>
                        <div class="comment-meta">
                            <time class="comment-time">2018-02-23</time>
                            <span class="comment-reply">
                                <a rel="nofollow" onclick="TaleComment.reply('6');">回复</a>
                            </span>
                        </div>
                    </div>
                </div>
            </li>
            <li id="li-comment-3" class="comment-body comment-parent comment-odd">
                <div id="comment-3">
                    <div class="comment-view" onclick="">
                        <div class="comment-header">
                            <img class="avatar" src="7a3b4d2e8fc3f271e875a60ad76bc150-s=80&r=G&d=" tppabs="https://secure.gravatar.com/avatar/7a3b4d2e8fc3f271e875a60ad76bc150?s=80&r=G&d=" title="瞎说"
                                 width="80" height="80">
                            <span class="comment-author">
                                <a href="" target="_blank" rel="external nofollow">瞎说</a>
                            </span>
                        </div>
                        <div class="comment-content">
                            <span class="comment-author-at"></span>
                            <p><p>可以，小伙子。</p>
</p>
                        </div>
                        <div class="comment-meta">
                            <time class="comment-time">2017-09-13</time>
                            <span class="comment-reply">
                                <a rel="nofollow" onclick="TaleComment.reply('3');">回复</a>
                            </span>
                        </div>
                    </div>
                </div>
            </li>
            <li id="li-comment-1" class="comment-body comment-parent comment-odd">
                <div id="comment-1">
                    <div class="comment-view" onclick="">
                        <div class="comment-header">
                            <img class="avatar" src="5e66b89fecf4d0f74fb2f9910b43ef57-s=80&r=G&d=" tppabs="https://secure.gravatar.com/avatar/5e66b89fecf4d0f74fb2f9910b43ef57?s=80&r=G&d=" title="路人甲"
                                 width="80" height="80">
                            <span class="comment-author">
                                <a href="" target="_blank" rel="external nofollow">路人甲</a>
                            </span>
                        </div>
                        <div class="comment-content">
                            <span class="comment-author-at"></span>
                            <p><p>这个评论可以改进下@-@</p>
</p>
                        </div>
                        <div class="comment-meta">
                            <time class="comment-time">2017-09-12</time>
                            <span class="comment-reply">
                                <a rel="nofollow" onclick="TaleComment.reply('1');">回复</a>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="comment-children">
                    <ol class="comment-list">
                        <li id="li-comment-2"
                            class="comment-body comment-child comment-level-odd comment-odd">
                            <div id="comment-2">
                                <div class="comment-view">
                                    <div class="comment-header">
                                        <img class="avatar" src="5e66b89fecf4d0f74fb2f9910b43ef57-s=80&r=G&d=" tppabs="https://secure.gravatar.com/avatar/5e66b89fecf4d0f74fb2f9910b43ef57?s=80&r=G&d=" title="路人甲" width="80" height="80">
                                        <span class="comment-author comment-by-author">
                                            <a href="" target="_blank" rel="external nofollow">路人甲</a>
                                        </span>
                                    </div>
                                    <div class="comment-content">
                                        <span class="comment-author-at">
                                            <a href="#comment-1">@路人甲</a>
                                        </span>
                                        <p><p>可以回复自己=_=</p>
</p>
                                    </div>
                                    <div class="comment-meta">
                                        <time class="comment-time">2017-09-12</time>
                                        <span class="comment-reply">
                                            <a rel="nofollow" onclick="TaleComment.reply('2');">回复</a>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ol>
                </div>
            </li>
        </ol>
        <div class="lists-navigator clearfix">
            <ol class="page-navigator">
                <li  class="current" ><a href="3-cp=1.htm#comments" tppabs="http://www.oyjie.cn/article/3?cp=1#comments">1</a></li>
            </ol>
            <br/><br/>
        </div>
    </div>
</div>
<script type="text/javascript">
(function () {
    window.TaleComment = {
        reply : function (coid) {
            $('#comment-form input[name=coid]').val(coid);
            $("html,body").animate({scrollTop: $('div.comment-container').offset().top}, 500);
            $('#comment-form #textarea').focus();
        },
        subComment: function () {
            $.ajax({
                type: 'post',
                url: '/comment',
                data: $('#comment-form').serialize(),
                async: false,
                dataType: 'json',
                success: function (result) {
                    $('#comment-form input[name=coid]').val('');
                    if (result && result.success) {
                        window.location.reload();
                    } else {
                        if (result.msg) {
                            alert(result.msg);
                        }
                    }
                }
            });
            return false;
        }
    };
})();
function getCommentCookie(name){
    var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");
    if(arr=document.cookie.match(reg))
        return unescape(decodeURI(arr[2]));
    else
        return null;
}
function addCommentInputValue(){
    document.getElementById('author').value = getCommentCookie('tale_remember_author');
    document.getElementById('mail').value = getCommentCookie('tale_remember_mail');
    document.getElementById('url').value = getCommentCookie('tale_remember_url');
}
function setDefaultInputValue(){
	var authorInput = $('#comment-form input[name=author]');
	var mailInput = $('#comment-form input[name=mail]');
	var author = authorInput.val();
	if(null == author || "" == author){
		var timestamp=new Date().getTime();
		authorInput.val("路人" + timestamp);
	}
	var mail = mailInput.val();
	if(null == mail || "" == mail){
		mailInput.val("user@mail.com.htm"/*tpa=http://www.oyjie.cn/article/user@mail.com*/);
	}
}
addCommentInputValue();
setDefaultInputValue();
</script>
    </div>
</div>
<div id="directory-content" class="directory-content">
    <div id="directory"></div>
</div>
<script>
    $('#directory').html('<a id="openHiddenLinkId" href="javascript:void(0)" isopen="0" style="display:block;float:right;z-index: 2000;">↗</a><p style="text-align: center;padding-bottom: 5px;color: #08c;">目录</p>');
    var postDirectoryBuild = function() {
        $("#openHiddenLinkId").click(function(){
            var isopen = $(this).attr("isopen");
            if(isopen == "1"){
              $('#directory').find("p,ul").show(200);
              $(this).attr("isopen","0").html("↗");
            }else{
              $('#directory').find("p,ul").hide(200);
              $(this).attr("isopen","1").html("↙");
            }
        });
        var postChildren = function children(childNodes, reg) {
                var result = [],
                    isReg = typeof reg === 'object',
                    isStr = typeof reg === 'string',
                    node, i, len;
                for (i = 0, len = childNodes.length; i < len; i++) {
                    node = childNodes[i];
                    if ((node.nodeType === 1 || node.nodeType === 9) &&
                        (!reg ||
                        isReg && reg.test(node.tagName.toLowerCase()) ||
                        isStr && node.tagName.toLowerCase() === reg)) {
                        result.push(node);
                    }
                }
                return result;
            },
            createPostDirectory = function(article, directory, isDirNum) {
                var contentArr = [],
                    titleId = [],
                    levelArr, root, level,
                    currentList, list, li, link, i, len;
                levelArr = (function(article, contentArr, titleId) {
                    var titleElem = postChildren(article.childNodes, /^h\d$/),
                        levelArr = [],
                        lastNum = 1,
                        lastRevNum = 1,
                        count = 0,
                        guid = 1,
                        id = 'directory' + (Math.random() + '').replace(/\D/, ''),
                        lastRevNum, num, elem;
                    while (titleElem.length) {
                        elem = titleElem.shift();
                        contentArr.push(elem.innerHTML);
                        num = +elem.tagName.match(/\d/)[0];
                        if (num > lastNum) {
                            levelArr.push(1);
                            lastRevNum += 1;
                        } else if (num === lastRevNum ||
                            num > lastRevNum && num <= lastNum) {
                            levelArr.push(0);
                            lastRevNum = lastRevNum;
                        } else if (num < lastRevNum) {
                            levelArr.push(num - lastRevNum);
                            lastRevNum = num;
                        }
                        count += levelArr[levelArr.length - 1];
                        lastNum = num;
                        elem.id = elem.id || (id + guid++);
                        titleId.push(elem.id);
                    }
                    if (count !== 0 && levelArr[0] === 1) levelArr[0] = 0;

                    return levelArr;
                })(article, contentArr, titleId);
                currentList = root = document.createElement('ul');
                dirNum = [0];
                for (i = 0, len = levelArr.length; i < len; i++) {
                    level = levelArr[i];
                    if (level === 1) {
                        list = document.createElement('ul');
                        if (!currentList.lastElementChild) {
                            currentList.appendChild(document.createElement('li'));
                        }
                        currentList.lastElementChild.appendChild(list);
                        currentList = list;
                        dirNum.push(0);
                    } else if (level < 0) {
                        level *= 2;
                        while (level++) {
                            if (level % 2) dirNum.pop();
                            currentList = currentList.parentNode;
                        }
                    }
                    dirNum[dirNum.length - 1]++;
                    li = document.createElement('li');
                    link = document.createElement('a');
                    link.href = '#' + titleId[i];
                    link.innerHTML = !isDirNum ? contentArr[i] :
                        dirNum.join('.') + ' ' + contentArr[i] ;
                    li.appendChild(link);
                    currentList.appendChild(li);
                }
                directory.appendChild(root);
            };
        createPostDirectory(document.getElementById('post-content'),document.getElementById('directory'), true);
    };
    postDirectoryBuild();
</script>
<script src="prism.js" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/js/prism.js"></script>
<div id="particles"></div>
<script src="particle.js" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/js/particle.js"></script>

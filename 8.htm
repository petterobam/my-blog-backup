<div id="container">
    <!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-transform"/>
    <meta name="sogou_site_verification" content="xSIboraCiG"/>
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <meta name="keywords" content="代码提交,代码合并,打包"/>
    <meta name="description" content="一段代码，一个故事"/>
    <link rel="shortcut icon" href="favicon.png" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/img/favicon.png"/>
    <link rel="apple-touch-icon" href="apple-touch-icon.png" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/img/apple-touch-icon.png"/>
    <script src="main.js" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/js/main.js"></script>
    <link href="style.min.css" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/css/style.min.css" rel="stylesheet">
    <link href="prism.css" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/css/prism.css" rel="stylesheet">
    <title>#2017-12-10# 关于代码提交、定版合并和打单包总结 - petterObam</title>
    <script src="particles.min.js" tppabs="http://cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script>
</head>
<body  gtools_scp_screen_capture_injected="true">
<!--[if lt IE 8]>
<div class="browsehappy" role="dialog">
    当前网页 <strong>不支持</strong> 你正在使用的浏览器. 为了正常的访问, 请 <a href="javascript:if(confirm(%27http://browsehappy.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://browsehappy.com/%27" tppabs="http://browsehappy.com/" target="_blank">升级你的浏览器</a>。
</div>
<![endif]-->
<div class="left-col">
    <div class="overlay"></div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="index.htm" tppabs="http://www.oyjie.cn/" class="profilepic">
                <img src="logo.png.jpg" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/img/logo.png" class="js-avatar">
            </a>
            <hgroup>
                <h1 class="header-author"><a href="index.htm" tppabs="http://www.oyjie.cn/">petterObam</a></h1>
                <p class="subtitle">一段代码，一个故事</p>
            </hgroup>
            <nav class="header-menu">
                <ul>
                    <li><a href="index.htm" tppabs="http://www.oyjie.cn/">主页</a></li>
                </ul>
            </nav>
            <nav class="header-smart-menu">
                <a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
                <a class="js-smart-menu" data-idx="1" href="javascript:void(0)">标签</a>
                <a class="js-smart-menu" data-idx="2" href="javascript:void(0)">友链</a>
                <a class="js-smart-menu" data-idx="3" href="javascript:void(0)">关于我</a>
            </nav>
            <nav class="header-nav">
                <div class="social">


                    <a class="social rss" target="blank" href="feed.htm" tppabs="http://www.oyjie.cn/feed">RSS</a>

                    <!---->
                    <a class="github" target="blank"
                       href="javascript:if(confirm(%27https://github.com/petterobam  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://github.com/petterobam%27" tppabs="https://github.com/petterobam">Github</a>
                    

                </div>
            </nav>
        </header>
    </div>
</div>
<div class="tools-col">
    <ul class="btn-wrap">
        <li class="" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
        <li data-hook="tools-section-tag" class="chose"><span class="text"></span><i class="icon-price-tags"></i></li>
        <li data-hook="tools-section-friends" class=""><span class="text">友链</span><i class="icon-link"></i></li>
        <li data-hook="tools-section-me"><span class="text">我</span><i class="icon-smile"></i></li>
    </ul>
    <div class="tools-wrap">
        <section class="tools-section tools-section-all">

        </section>
        <section class="tools-section tools-section-tag chose">
            <div class="widget tagcloud" id="js-tagcloud">
                <a href="PDF.htm" tppabs="http://www.oyjie.cn/tag/PDF" style="font-size: 12px;" class="color3">PDF</a>
                <a href="CentOs.htm" tppabs="http://www.oyjie.cn/tag/CentOs" style="font-size: 12px;" class="color3">CentOs</a>
                <a href="sqlite.htm" tppabs="http://www.oyjie.cn/tag/sqlite" style="font-size: 12px;" class="color3">sqlite</a>
                <a href="面向对象.htm" tppabs="http://www.oyjie.cn/tag/面向对象" style="font-size: 12px;" class="color3">面向对象</a>
                <a href="封装.htm" tppabs="http://www.oyjie.cn/tag/封装" style="font-size: 12px;" class="color3">封装</a>
                <a href="数据库.htm" tppabs="http://www.oyjie.cn/tag/数据库" style="font-size: 12px;" class="color3">数据库</a>
                <a href="打包.htm" tppabs="http://www.oyjie.cn/tag/打包" style="font-size: 12px;" class="color3">打包</a>
                <a href="代码合并.htm" tppabs="http://www.oyjie.cn/tag/代码合并" style="font-size: 12px;" class="color3">代码合并</a>
                <a href="代码提交.htm" tppabs="http://www.oyjie.cn/tag/代码提交" style="font-size: 12px;" class="color3">代码提交</a>
                <a href="文本分析.htm" tppabs="http://www.oyjie.cn/tag/文本分析" style="font-size: 12px;" class="color3">文本分析</a>
                <a href="聚类.htm" tppabs="http://www.oyjie.cn/tag/聚类" style="font-size: 12px;" class="color3">聚类</a>
                <a href="分词.htm" tppabs="http://www.oyjie.cn/tag/分词" style="font-size: 12px;" class="color3">分词</a>
                <a href="WORD.htm" tppabs="http://www.oyjie.cn/tag/WORD" style="font-size: 12px;" class="color3">WORD</a>
                <a href="数据提取.htm" tppabs="http://www.oyjie.cn/tag/数据提取" style="font-size: 12px;" class="color3">数据提取</a>
                <a href="解析.htm" tppabs="http://www.oyjie.cn/tag/解析" style="font-size: 12px;" class="color3">解析</a>
                <a href="Word-1.htm" tppabs="http://www.oyjie.cn/tag/Word" style="font-size: 12px;" class="color3">Word</a>
                <a href="Tale.htm" tppabs="http://www.oyjie.cn/tag/Tale" style="font-size: 12px;" class="color3">Tale</a>
                <a href="项目经理.htm" tppabs="http://www.oyjie.cn/tag/项目经理" style="font-size: 12px;" class="color3">项目经理</a>
                <a href="项目管控.htm" tppabs="http://www.oyjie.cn/tag/项目管控" style="font-size: 12px;" class="color3">项目管控</a>
                <a href="邮件.htm" tppabs="http://www.oyjie.cn/tag/邮件" style="font-size: 12px;" class="color3">邮件</a>
                <a href="定时任务.htm" tppabs="http://www.oyjie.cn/tag/定时任务" style="font-size: 12px;" class="color3">定时任务</a>
                <a href="maillx.htm" tppabs="http://www.oyjie.cn/tag/maillx" style="font-size: 12px;" class="color3">maillx</a>
                <a href="搭建.htm" tppabs="http://www.oyjie.cn/tag/搭建" style="font-size: 12px;" class="color3">搭建</a>
                <a href="博客.htm" tppabs="http://www.oyjie.cn/tag/博客" style="font-size: 12px;" class="color3">博客</a>
                <a href="aaa.htm" tppabs="http://www.oyjie.cn/tag/aaa" style="font-size: 12px;" class="color3">aaa</a>
                <a href="心得.htm" tppabs="http://www.oyjie.cn/tag/心得" style="font-size: 12px;" class="color3">心得</a>
                <a href="linux.htm" tppabs="http://www.oyjie.cn/tag/linux" style="font-size: 12px;" class="color3">linux</a>
                <a href="tale-1.htm" tppabs="http://www.oyjie.cn/tag/tale" style="font-size: 12px;" class="color3">tale</a>
            </div>
        </section>
        <section class="tools-section tools-section-friends">
            <div class="friends-wrap" id="js-friends">
                <a target="_blank" class="main-nav-link switch-friends-link" href="javascript:if(confirm(%27http://mindhacks.cn/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://mindhacks.cn/%27" tppabs="http://mindhacks.cn/">刘未鹏 | Mind Hacks</a>
                <a target="_blank" class="main-nav-link switch-friends-link" href="javascript:if(confirm(%27http://www.xiashuo.online/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.xiashuo.online/%27" tppabs="http://www.xiashuo.online/">把灯瞎说的博客</a>
                <a target="_blank" class="main-nav-link switch-friends-link" href="javascript:if(confirm(%27http://biezhi.me/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://biezhi.me/%27" tppabs="http://biezhi.me/">王爵的技术博客</a>
            </div>
        </section>
        <section class="tools-section tools-section-me">
            <div class="aboutme-wrap" id="js-aboutme"></div>
        </section>
    </div>
</div>

    <div class="mid-col">
        <article class="article article-type-post  animated fadeInLeft" itemscope="" itemprop="blogPost">
            <div class="article-inner">
                <input type="hidden" class="isFancy">
                <header class="article-header">
                    <h1 itemprop="name">
                        <a name="title" class="article-title" href="8.htm" tppabs="http://www.oyjie.cn/article/8">#2017-12-10# 关于代码提交、定版合并和打单包总结</a>
                    </h1>
                </header>
                <div id="post-content" class="article-entry" itemprop="articleBody">
                    <p><h2>前情提要</h2>
<p>鉴于最近公司旅游及同学聚会，琐事蛮多，疏于记录，特提笔写写最近的东西。</p>
<p>背景：前些日子，公司核心产品终测环境打包编译屡屡出问题，特此做一些通用总结。</p>
<h2>代码提交</h2>
<h3>每次提交的最小单位是安全的整体逻辑或弱关联文本</h3>
<p>愿我们每个人都将代码提交演绎为一项神圣的仪式，了解提交的魅力。</p>
<pre><code>安全：不影响启动的逻辑、不影响原先业务的逻辑。
整体逻辑：保证不随意提交零散代码。整体提交能保证安全，拆开提交则有隐患。
弱关联文本：新增文件的时候，弱关联文本单独提交无隐患。
</code></pre>
<h4>整体逻辑定义</h4>
<ul>
<li>
<p>1）一个业务功能</p>
</li>
<li>
<p>2）一个服务功能</p>
</li>
<li>
<p>3）单个bug的处理</p>
</li>
<li>
<p>4）其他</p>
<p>代码层面上逻辑闭合（基于SVN上已有的类的引用，做的一整套修改）以ASMS为例：</p>
<ul>
<li>如果你<font color="red">修改</font>的是controller，则你需要检查对应的页面</li>
<li>如果你<font color="red">修改</font>的是一个service，则你需要检查引用这个service的其他service和controller；</li>
<li>如果你<font color="red">修改</font>的是一个<font color="red">dao</font>，则你需要检查对应的Mapper和service；</li>
<li>如果你<font color="red">修改</font>的是一个<font color="red">Mapper</font>，则你需要检查对应的<font color="red">数据库环境</font>、dao和service；</li>
<li>如果你<font color="red">修改</font>的是一个<font color="red">entity</font>（关联表的JavaBean），则你需要检查<font color="red">所有</font>。</li>
</ul>
</li>
</ul>
<p>当然，这些检查并不是真的要跑到每个地方去看，我们要善于利用intellij的编译工具和我们的经验，保证代码编译逻辑正确（启动）、业务逻辑正确（需求落实）、功能逻辑正确（需求落实+异常处理）</p>
<h4>弱关联文本的定义</h4>
<p>所谓的弱关联文本，就是不依赖或仅仅依赖于原来SVN的环境，不依赖于任何新的文件的文本，他们都可以直接提交。</p>
<ul>
<li>
<p>纯粹的弱关联文本</p>
<ul>
<li>1)你<font color="red">新增</font>了一个JavaBean，并且引用的类和方法是原先SVN仓库里面已经有的，这样的JavaBean可以单独提交；</li>
<li>2)你<font color="red">新增</font>了一个js、css或icon等static里面的静态文本，这些可以先单独提交。</li>
</ul>
</li>
<li>
<p>有前提条件下的弱关联文本</p>
<ul>
<li>1)<font color="red">不影响启动的前提下</font>，所有的static和view下吗的文件都是弱关联文本。</li>
</ul>
</li>
</ul>
<h4>强关联文本的定义</h4>
<p>有弱关联文本必有对应的强关联文本，这些东西的提交一定要有个概念。</p>
<ul>
<li>
<p>1）所有于数据库交互的文本（<font color="red">Mapper、Entity</font>）或于数据库中间件交互的文本（<font color="red">Dao</font>）都是强关联文本，他们的新增都需要进行规范的检查，步骤从（数据库环境=&gt;Entity[与数据库对应的JavaBean]=&gt;Mapper=&gt;Dao=&gt;编译=&gt;<font color="red">启动自测</font>）；</p>
</li>
<li>
<p>2）所有使用到其他项目的类的类都是强关联文本，比如实现继承、spring注入、JavaBean引入实体等，需要进行规范的检查（[确认Mvn的版本是最近的，至少是三天以内的]=&gt;编译=&gt;<font color="red">启动自测</font>）；</p>
</li>
<li>
<p>3）所有<font color="red">系统配置文件</font>都是强关联文本，包括<font color="red">property</font>、source下的<font color="red">xml</font>文件和maven工程的<font color="red">pom</font>文件，这些文档的提交需要找组长和对应的技术经理，系统框架级别的要找CTO的确认，禁止单独提交。</p>
</li>
</ul>
<h3>每次提交都要遵照标准的提交步骤</h3>
<h4>提交代码前的最低标准</h4>
<ul>
<li>1)<font color="red">所在环境编译无误</font></li>
<li>2)最高标准：所在环境启动无误，并且代码彻底解决了某个bug、完全实现了某个功能</li>
</ul>
<h4>小乌龟操作步骤</h4>
<ul>
<li>
<p>1)更新你要提交的项目的代码（如有冲突，请先解决冲突，并返回1.2.1）</p>
</li>
<li>
<p>2)Commit预览，预览时要确定两点：</p>
<ul>
<li>
<p>a)要提交的文件的数量</p>
<p>注：在排除了配置文件后的文件数量，配置文件找组长和技术经理提交</p>
</li>
<li>
<p>b)检查每个你要提交的java文件和Mapper文件，修改的地方是否是你的代码，避免提交他人的代码</p>
<p>注：java文件要特别注意导入的包，很多情况下是导入了无用的包，导致了代码的问题，可以对自己的intellij idea做如下设置</p>
</li>
</ul>
<p><img src="qjtsinc654j8mqb0u2rnorq1nd.png" tppabs="http://www.oyjie.cn/upload/2017/12/qjtsinc654j8mqb0u2rnorq1nd.png" alt="自动导包设置" /></p>
<blockquote>
<p>勾选标注 1 选项，IntelliJ IDEA 将在我们书写代码的时候自动帮我们优化导入的包，比如自动去掉一些没有用到的包。 <br/>
勾选标注 2 选项，IntelliJ IDEA 将在我们书写代码的时候自动帮我们导入需要用到的包。但是对于那些同名的包，还是需要手动 Alt + Enter 进行导入的<br/>
<font color="red">一般勾选标注 1 即可</font>，标注 2 不勾选，有利于我们在编程的时候了解一些工具类的路径，这是一个即时学习的过程。</p>
</blockquote>
</li>
<li>
<p>3)写好备注</p>
<ul>
<li>a)如果是bug，请附上bug的标题及ID，详细可以追加产生原因和处理方案，总结的过程，提升贼快；</li>
<li>b)如果是需求，请附上需求说明，及该批代码完成了需求的哪一块；</li>
<li>c)如果是其他功能，请附上功能描述，及完成了该功能的哪一块；</li>
<li>d)如果是其他，请附上明确备注</li>
</ul>
</li>
<li>
<p>4)提交，并跟进相关环境的更新情况，及时查看代码影响的模块，自测。</p>
</li>
</ul>
<h4>提交情况告知组长</h4>
<p>组长有义务监督组员代码的提交，特别是定版的代码提交，但是提交过程何其多，组长无法一一顾及，所以需要组员主动汇报组长自身提交的动态，不然出了问题组长会很不爽哦。</p>
<p><font color="red">提交完开发环境</font>，需要告知组长，可以简单的发个消息，告知你提交的版本、描述和时间。</p>
<p>当然，个人建议可以用通讯工具建立一个组内代码提交动态群，组长可以浏览每天的提交动态。</p>
<p><img src="1hoihoum3ugcrqqhos1akaq7hu.png" tppabs="http://www.oyjie.cn/upload/2017/12/1hoihoum3ugcrqqhos1akaq7hu.png" alt="组内代码提交群" /></p>
<h2>定版合并</h2>
<p>SVN开发版本到定版的代码迁移过程，称为定版合并过程。</p>
<h3>定版合并先决条件</h3>
<h4>保证合并的代码来源无误</h4>
<p>开发版的代码需要满足解决了某个bug，完成了某个需求，实现了某个功能，并测试通过。</p>
<h4>待合并的版本清单</h4>
<p>清楚要合并的代码在开发版上的提交版本清单，需要合并哪些提交记录，才能组成一个逻辑整体。</p>
<h4>明确清楚合并顺序</h4>
<p>当出现多个模块合成一个整体逻辑的时候，明确清楚合并顺序。例如修改了OpenApi，如果有其他的合作项目，则其他项目的合并在前。</p>
<h3>定版合并步骤</h3>
<p>定版合并前一定要保证开发版代码正确，否则合并定版就如同一场儿戏。</p>
<h4>Merge的原则和原理</h4>
<p>Merge是一个代码选择性拷贝的过程，了解其原理有助于我们更流畅的Merge，减少发生冲突的次数及减轻对冲突的恐惧。</p>
<ul>
<li>
<p>1)先更新你需要提交的项目目录。</p>
<p>只要你的本地代码在版本中，更新必定不会产生冲突。定版代码我们都不会手动在上面编辑，所以更新的时候不会与你的定版代码冲突，如有冲突，说明你对本地的定版代码做了编辑修改，这个时候只需要还原整个项目的代码，在进行更新即可。</p>
</li>
<li>
<p>2)选择对应的远程版本，Merge预览</p>
<p>少量的代码合并很容易Merge，但也不能轻视，往往就是这种情况让我们掉以轻心。</p>
<p>大量代码的合并可能让我们疲于应付，但是Merge只是一个代码远程Copy的过程，这里可以简单的分享一些技巧。</p>
<p>背景1：例如，你最近半个月都在做一个需求项目，并且你们组的其他人也全部参与其中，在这期间你的组员可能还时不时改改其他业务bug，但是跟这个新项目有关的东西在没做完前都只能提交开发的SVN。这种情况下，我就会定下规矩，关于新需求项目的代码提交备注统一添加前缀——XXXXX项目：[你的SVN备注]。如此一来，半个月之后，项目开发完成后，需要在终测上测试了，这个时候我利用Merge预览就可以轻松找到我要合并的代码，而这些代码集合就是这个项目的整体逻辑，高效、完美。</p>
<ul>
<li>a.通过<font color="red">Next 100</font>按钮调整你的项目开始时间From</font></li>
<li>b.通过小乌龟的通配搜索功能，记住使用正则功能一定要勾选 <font color="red">use regular expression</font></li>
<li>c.有些备注模糊不清的地方，组长需要找到对应的组员确认，<font color="red">并纠正告诫</font></li>
</ul>
<p><img src="3i7nfqp7vkjd7qs1461v4g6ov0.png" tppabs="http://www.oyjie.cn/upload/2017/12/3i7nfqp7vkjd7qs1461v4g6ov0.png" alt="svn的merge示例" /></p>
</li>
</ul>
<p>然后，开始Merge，庆幸的是该项目的Merge没有出现任何冲突，虽然归功于良好的注释和整体逻辑的提交原则，但是这并不意味着不会出现冲突的Merge情况了。</p>
<p>往往一个项目时长越长，业务关联越多，可能出现的问题也会越多，牵扯到的业务越多，交叉修改文件的频率也会越频繁，这样通过搜索出来的的文件很大概率跨了很多未合并的版本。</p>
<p>例如，我在版本里面随机选择一些版本进行合并</p>
<p><img src="vjvk33sq74iajologp27rhem3h.png" tppabs="http://www.oyjie.cn/upload/2017/12/vjvk33sq74iajologp27rhem3h.png" alt="随机代码合并" /></p>
<p>这种文件树的冲突，一般指文件夹，就算是文件也可以直接不管，标记为已解决即可</p>
<p><img src="slmsm4v218j9mrjfu7jfmvbrrf.png" tppabs="http://www.oyjie.cn/upload/2017/12/slmsm4v218j9mrjfu7jfmvbrrf.png" alt="文件夹冲突" /></p>
<p>像这种文件类的冲突，如果你不擅长或不确定如何Edit conflict，可以先选择合并接收开发版本的SVN最新版，快速完成Merge的过程，并且确保你的代码能过来是最重要的。</p>
<p><img src="23oi0ni1mqggbpfhdmond8ftac.png" tppabs="http://www.oyjie.cn/upload/2017/12/23oi0ni1mqggbpfhdmond8ftac.png" alt="文件冲突" /></p>
<p>这样，你的代码就“毫无Conflict”的情况下Merge到了本地的定版，这样就结束了吗？</p>
<p>No，上面都是无关紧要的必要步骤，下面的才是重中之重。</p>
<h4>有意识的检查</h4>
<p>检查是一项很枯燥的工作，很容易让人失去耐性，但是如果是有意识的检查，有明确的目标，那么这项工作就变得流畅而富于意义，至少对于当时的你是这样的。</p>
<p>首先打开你Merge的项目的提交预览界面，不要写提交备注</p>
<p>预览要确定的一些东西，即目标：</p>
<ul>
<li>
<p>a)要提交的文件的数量</p>
<p>注：在排除了配置文件后的文件数量，配置文件找组长和技术经理提交</p>
</li>
<li>
<p>b)检查每个你要提交的java文件和Mapper文件</p>
<p>注：确定修改的地方是你的代码。</p>
</li>
<li>
<p>c)<font color="red">重点检查Merge过程中发生过冲突的文件</font></p>
<p>注：这样的文件必定是少量，如果有很多，你就要慎重一点了，找找原因你会发现，可能有正在130测试中的需求没有合并到定版，也可能会有很久远的代码没有合并到定版了，然后幸运的被你发现了，<font color="red">解决他</font>。</p>
</li>
</ul>
<p><strong>提问：如果Merge过程中，没有出现一次<font color="red">Conflict</font>的提示，是不是意味着可以绝对不会有问题？</strong></p>
<blockquote>
<p>答：不是。这只能说明你Merge的代码一定是你提交的那些代码，如果是一个整体逻辑，那确实没有问题，可是问题是可能不是一个整体逻辑，比如出现1.2.2中你提交到开发版有<font color="red">import</font>无用的包，恰好你没有设置自动清除无用的包，而这个依赖的类在定版正好没有，那你的这次提交就是一个<font color="red">伪整体逻辑</font>，就会导致定版启动异常。</p>
</blockquote>
<p>如何判断你的每一次提交是否是整体逻辑呢？下面的步骤才是无罪证书获取流程。</p>
<h4>编译都没问题了，那才是没问题</h4>
<p>我们用intellij idea打开我们定版的工程：</p>
<ul>
<li>1)确保你定版的idea工程的Maven是三天以内的版本（看overlay里面的子项目时间）。</li>
<li>2)确保idea工程的每个Module是最新的，不是就更新。</li>
</ul>
<p>打开idea工程的Maven Projects，展开你要提交的子项目的lifecycle，clear、compile，
<font color="blue">Process finished with exit code 0</font> 代表你可以喝口茶了。</p>
<p>最后，提交代码，再次简单检查一下，写好备注，提交代码，并实时关注终测环境的更新状态，确保你提交的代码不但安全，并且有效（满足了需求？解决了问题？实现了功能？）。</p>
<h2>定版打单包</h2>
<p><font color="red">如果是用于终测或客户环境，请在本地定版打单包</font>。</p>
<h3>定版打包的先决条件</h3>
<ul>
<li>1)保证定版idea项目Maven是三天以内</li>
<li>2)保证你要打包的子项目Maven编译无误</li>
</ul>
<h3>定版打包的技巧</h3>
<h4>定版打单包的痛点</h4>
<p><strong><font size="20px">慢！</font></strong></p>
<p>借助我们原来的打包工具</p>
<p>和与tomcat一致的子目录</p>
<p><img src="6e36b3aj6ii6cr09jcph8npa99.png" tppabs="http://www.oyjie.cn/upload/2017/12/6e36b3aj6ii6cr09jcph8npa99.png" alt="tomcat发布包" /></p>
<p>请问你要什么样的包，我都可以给你。</p>
<p>定版打包让人比较难受的是，编译启动太耗时间，然而这往往是喜欢从主项目的target目录下打包的人的烦恼，当然这种情况打的包自然是没问题，但是要全部编译并发布到主项目target太耗时，特别是我们的核心产品的项目。</p>
<p>但是回头想想，为啥当初要将一个项目分离成这么多个项目，不就是为了降低不同组之间的相互影响，如果每个组自身的代码没有problem，那么整个项目就理应No problem。同理，打包原理也是类似，可以分离打包，基于tomcat的特性，我们如果能够创造那样的目录结构和所需的文件，借助打包工具，往往会事半功倍呢。</p>
<h4>定版打单包的技巧</h4>
<ul>
<li>
<p>1)在桌面创建一个文件夹</p>
<p><img src="pbumj6iq4sjnioqhh06mr579m2.png" tppabs="http://www.oyjie.cn/upload/2017/12/pbumj6iq4sjnioqhh06mr579m2.png" alt="打包区" /></p>
</li>
<li>
<p>2)将你要打包的定版子项目webapp文件夹下的文件夹拷入其中</p>
<p><img src="774mlo5nbkhs3ra142t0t02alk.png" tppabs="http://www.oyjie.cn/upload/2017/12/774mlo5nbkhs3ra142t0t02alk.png" alt="子项目目录" /></p>
<p><img src="54o0qq6iregvap1fu7c7a3cd65.png" tppabs="http://www.oyjie.cn/upload/2017/12/54o0qq6iregvap1fu7c7a3cd65.png" alt="打包子项目" /></p>
<p>当然，如果你打包的项目里面没有static类的文件可以不拷贝static文件夹，如果没有view类文件，课可以不拷贝WEB-INF文件，直接新建一个WEB-INF文件夹即可</p>
</li>
<li>
<p>3)在idea定版项目上Maven clear、compile你的子项目</p>
<p><img src="5g5r10utkihfaok3silof1fg0m.png" tppabs="http://www.oyjie.cn/upload/2017/12/5g5r10utkihfaok3silof1fg0m.png" alt="子项目编译" /></p>
</li>
<li>
<p>4)确保编译无误后，将你要提交的项目下的target文件下的classes文件夹拷入WEB-INF目录中</p>
<p><img src="ptngqv77vehocpuga81lvpc0oi.png" tppabs="http://www.oyjie.cn/upload/2017/12/ptngqv77vehocpuga81lvpc0oi.png" alt="子项目编译结果" /></p>
</li>
<li>
<p>5)然后就创造了单个子项目的打包环境</p>
<p><img src="pphm6r3he2hgjo9gpv8oke257k.png" tppabs="http://www.oyjie.cn/upload/2017/12/pphm6r3he2hgjo9gpv8oke257k.png" alt="项目打包区" /></p>
</li>
<li>
<p>6)根据提交记录打包</p>
<p><img src="pfphd8dp0ehsep0befqrjnel1p.png" tppabs="http://www.oyjie.cn/upload/2017/12/pfphd8dp0ehsep0befqrjnel1p.png" alt="SVN提交日志" /></p>
<p>注：如果文件成批的在某个文件夹内，可以批量的拖进打包工具。</p>
</li>
</ul>
</p>
                    <p class="post-info">
                        本文由 <a href="">petterObam</a> 创作，采用 <a href="javascript:if(confirm(%27https://creativecommons.org/licenses/by/4.0/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://creativecommons.org/licenses/by/4.0/%27" tppabs="https://creativecommons.org/licenses/by/4.0/"
                                                           target="_blank"
                                                           rel="external nofollow">知识共享署名4.0</a> 国际许可协议进行许可<br>本站文章除注明转载/出处外，均为本站原创或翻译，转载前请务必署名<br>最后编辑时间为:
                        2018/02/04 02:20
                    </p>
                </div>
                <div class="article-info article-info-index">
                    <div class="article-tag tagcloud">
                        <i class="icon-price-tags"></i>
                        <ul class="article-tag-list">
                            <li class="article-tag-list-item"><a class="color3" href="#"
                                                                 style="font-size: 12px;"><a href="代码提交-1.htm" tppabs="http://www.oyjie.cn/tag/%E4%BB%A3%E7%A0%81%E6%8F%90%E4%BA%A4">代码提交</a><a href="代码合并-1.htm" tppabs="http://www.oyjie.cn/tag/%E4%BB%A3%E7%A0%81%E5%90%88%E5%B9%B6">代码合并</a><a href="打包-1.htm" tppabs="http://www.oyjie.cn/tag/%E6%89%93%E5%8C%85">打包</a></a></li>
                        </ul>
                    </div>
                    <div class="post-data archive-article-date">
                        <time datetime="2017-12-10" itemprop="datePublished">发布于 2017-12-10
                        </time>
                        /<span> <a href="体会.htm" tppabs="http://www.oyjie.cn/category/%E4%BD%93%E4%BC%9A">体会</a><a href="SVN.htm" tppabs="http://www.oyjie.cn/category/SVN">SVN</a> </span>/ <a href="#comments">没有评论</a> /
                        10浏览<a name="footer">.</a>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>
        </article>

		<div id="post-bottom-bar" class="post-bottom-bar">
		    <div class="bottom-bar-inner">
		        <div class="bottom-bar-items social-share left">
		            <span class="bottom-bar-item">Share : </span>
		            <span class="bottom-bar-item bottom-bar-facebook"><a href="javascript:if(confirm(%27https://www.facebook.com/sharer/sharer.php?u=http://www.oyjie.cn/article/8  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://www.facebook.com/sharer/sharer.php?u=http://www.oyjie.cn/article/8%27" tppabs="https://www.facebook.com/sharer/sharer.php?u=http://www.oyjie.cn/article/8" target="_blank" title="#2017-12-10# 关于代码提交、定版合并和打单包总结" rel="nofollow">facebook</a></span>
		            <span class="bottom-bar-item bottom-bar-twitter"><a href="javascript:if(confirm(%27https://twitter.com/intent/tweet?url=http://www.oyjie.cn/article/8&text=  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://twitter.com/intent/tweet?url=http://www.oyjie.cn/article/8&text=#2017-12-10# 关于代码提交、定版合并和打单包总结%27" tppabs="https://twitter.com/intent/tweet?url=http://www.oyjie.cn/article/8&text=#2017-12-10# 关于代码提交、定版合并和打单包总结" target="_blank" title="#2017-12-10# 关于代码提交、定版合并和打单包总结" rel="nofollow">Twitter</a></span>
		            <span class="bottom-bar-item bottom-bar-weibo"><a href="javascript:if(confirm(%27http://service.weibo.com/share/share.php?url=http://www.oyjie.cn/article/8&title=  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://service.weibo.com/share/share.php?url=http://www.oyjie.cn/article/8&title=#2017-12-10# 关于代码提交、定版合并和打单包总结%27" tppabs="http://service.weibo.com/share/share.php?url=http://www.oyjie.cn/article/8&title=#2017-12-10# 关于代码提交、定版合并和打单包总结" target="_blank" title="#2017-12-10# 关于代码提交、定版合并和打单包总结" rel="nofollow">Weibo</a></span>
		            <span class="bottom-bar-item bottom-bar-qrcode"><a href="javascript:if(confirm(%27http://pan.baidu.com/share/qrcode?w=300&h=300&url=http://www.oyjie.cn/article/8  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://pan.baidu.com/share/qrcode?w=300&h=300&url=http://www.oyjie.cn/article/8%27" tppabs="http://pan.baidu.com/share/qrcode?w=300&h=300&url=http://www.oyjie.cn/article/8" target="_blank" rel="nofollow">QRcode</a></span>
		        </div>
		        <div class="bottom-bar-items right">
		            <span class="bottom-bar-item"><a href="3.htm" tppabs="http://www.oyjie.cn/article/3" title="#2017-09-10# Tale模板框架博客搭建记录">→</a></span>
		            <span class="bottom-bar-item"><a href="9.htm" tppabs="http://www.oyjie.cn/article/9" title="#2018-02-21# 数据库面向对象封装[干货]">←</a></span>
		            <span class="bottom-bar-item"><a href="#footer">↓</a></span>
		            <span class="bottom-bar-item"><a href="#title">↑</a></span>
		        </div>
		    </div>
		</div>
		
        <div id="8" class="comment-container">
    <div id="comments" class="clearfix">
        <span class="response"></span>

        <form method="post" id="comment-form" class="comment-form" role="form" onsubmit="return TaleComment.subComment();">
            <input type="hidden" name="coid" id="coid"/>
            <input type="hidden" name="cid" id="cid" value="8"/>
            <input type="hidden" name="_csrf_token" value="fOChmjXEI1uzWPg4zcvgM2"/>
            <input type="text" name="author" maxlength="12" id="author" class="form-control input-control clearfix"
                   placeholder="姓名 (*)" value="" required/>
            <input type="email" name="mail" id="mail" class="form-control input-control clearfix" placeholder="邮箱 (*)"
                   value="" required/>
            <input type="url" name="url" id="url" class="form-control input-control clearfix" placeholder="网址 (http://)"
                   value=""/>
            <textarea name="text" id="textarea" class="form-control" placeholder="请留下你的评论..." required minlength="5" maxlength="2000"></textarea>
            <button type="submit" class="submit" id="misubmit">提交</button>
        </form><br/>




    </div>
</div>
<script type="text/javascript">
(function () {
    window.TaleComment = {
        reply : function (coid) {
            $('#comment-form input[name=coid]').val(coid);
            $("html,body").animate({scrollTop: $('div.comment-container').offset().top}, 500);
            $('#comment-form #textarea').focus();
        },
        subComment: function () {
            $.ajax({
                type: 'post',
                url: '/comment',
                data: $('#comment-form').serialize(),
                async: false,
                dataType: 'json',
                success: function (result) {
                    $('#comment-form input[name=coid]').val('');
                    if (result && result.success) {
                        window.location.reload();
                    } else {
                        if (result.msg) {
                            alert(result.msg);
                        }
                    }
                }
            });
            return false;
        }
    };
})();
function getCommentCookie(name){
    var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");
    if(arr=document.cookie.match(reg))
        return unescape(decodeURI(arr[2]));
    else
        return null;
}
function addCommentInputValue(){
    document.getElementById('author').value = getCommentCookie('tale_remember_author');
    document.getElementById('mail').value = getCommentCookie('tale_remember_mail');
    document.getElementById('url').value = getCommentCookie('tale_remember_url');
}
function setDefaultInputValue(){
	var authorInput = $('#comment-form input[name=author]');
	var mailInput = $('#comment-form input[name=mail]');
	var author = authorInput.val();
	if(null == author || "" == author){
		var timestamp=new Date().getTime();
		authorInput.val("路人" + timestamp);
	}
	var mail = mailInput.val();
	if(null == mail || "" == mail){
		mailInput.val("user@mail.com.htm"/*tpa=http://www.oyjie.cn/article/user@mail.com*/);
	}
}
addCommentInputValue();
setDefaultInputValue();
</script>
    </div>
</div>
<div id="directory-content" class="directory-content">
    <div id="directory"></div>
</div>
<script>
    $('#directory').html('<a id="openHiddenLinkId" href="javascript:void(0)" isopen="0" style="display:block;float:right;z-index: 2000;">↗</a><p style="text-align: center;padding-bottom: 5px;color: #08c;">目录</p>');
    var postDirectoryBuild = function() {
        $("#openHiddenLinkId").click(function(){
            var isopen = $(this).attr("isopen");
            if(isopen == "1"){
              $('#directory').find("p,ul").show(200);
              $(this).attr("isopen","0").html("↗");
            }else{
              $('#directory').find("p,ul").hide(200);
              $(this).attr("isopen","1").html("↙");
            }
        });
        var postChildren = function children(childNodes, reg) {
                var result = [],
                    isReg = typeof reg === 'object',
                    isStr = typeof reg === 'string',
                    node, i, len;
                for (i = 0, len = childNodes.length; i < len; i++) {
                    node = childNodes[i];
                    if ((node.nodeType === 1 || node.nodeType === 9) &&
                        (!reg ||
                        isReg && reg.test(node.tagName.toLowerCase()) ||
                        isStr && node.tagName.toLowerCase() === reg)) {
                        result.push(node);
                    }
                }
                return result;
            },
            createPostDirectory = function(article, directory, isDirNum) {
                var contentArr = [],
                    titleId = [],
                    levelArr, root, level,
                    currentList, list, li, link, i, len;
                levelArr = (function(article, contentArr, titleId) {
                    var titleElem = postChildren(article.childNodes, /^h\d$/),
                        levelArr = [],
                        lastNum = 1,
                        lastRevNum = 1,
                        count = 0,
                        guid = 1,
                        id = 'directory' + (Math.random() + '').replace(/\D/, ''),
                        lastRevNum, num, elem;
                    while (titleElem.length) {
                        elem = titleElem.shift();
                        contentArr.push(elem.innerHTML);
                        num = +elem.tagName.match(/\d/)[0];
                        if (num > lastNum) {
                            levelArr.push(1);
                            lastRevNum += 1;
                        } else if (num === lastRevNum ||
                            num > lastRevNum && num <= lastNum) {
                            levelArr.push(0);
                            lastRevNum = lastRevNum;
                        } else if (num < lastRevNum) {
                            levelArr.push(num - lastRevNum);
                            lastRevNum = num;
                        }
                        count += levelArr[levelArr.length - 1];
                        lastNum = num;
                        elem.id = elem.id || (id + guid++);
                        titleId.push(elem.id);
                    }
                    if (count !== 0 && levelArr[0] === 1) levelArr[0] = 0;

                    return levelArr;
                })(article, contentArr, titleId);
                currentList = root = document.createElement('ul');
                dirNum = [0];
                for (i = 0, len = levelArr.length; i < len; i++) {
                    level = levelArr[i];
                    if (level === 1) {
                        list = document.createElement('ul');
                        if (!currentList.lastElementChild) {
                            currentList.appendChild(document.createElement('li'));
                        }
                        currentList.lastElementChild.appendChild(list);
                        currentList = list;
                        dirNum.push(0);
                    } else if (level < 0) {
                        level *= 2;
                        while (level++) {
                            if (level % 2) dirNum.pop();
                            currentList = currentList.parentNode;
                        }
                    }
                    dirNum[dirNum.length - 1]++;
                    li = document.createElement('li');
                    link = document.createElement('a');
                    link.href = '#' + titleId[i];
                    link.innerHTML = !isDirNum ? contentArr[i] :
                        dirNum.join('.') + ' ' + contentArr[i] ;
                    li.appendChild(link);
                    currentList.appendChild(li);
                }
                directory.appendChild(root);
            };
        createPostDirectory(document.getElementById('post-content'),document.getElementById('directory'), true);
    };
    postDirectoryBuild();
</script>
<script src="prism.js" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/js/prism.js"></script>
<div id="particles"></div>
<script src="particle.js" tppabs="http://www.oyjie.cn/templates/themes/theme_iiice/static/js/particle.js"></script>
